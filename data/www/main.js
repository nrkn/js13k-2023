(()=>{"use strict";const e=160,t={bg:{x:220,y:183,width:40,height:31},frames:[{shoulderBack:{x:12.5,y:15.5},elbowBack:{x:15.5,y:17.5},handBack:{x:13,y:20},hipBack:{x:11,y:24},kneeBack:{x:12.5,y:26.5},heelBack:{x:11.5,y:29.5},torso:{x:6,y:15,width:7,height:9},shoulderFront:{x:5.5,y:15.5},elbowFront:{x:1.5,y:17.5},handFront:{x:5,y:20},hipFront:{x:6,y:24},kneeFront:{x:4.5,y:25.5},heelFront:{x:4.5,y:29.5}},{shoulderBack:{x:12.5,y:16.5},elbowBack:{x:15.5,y:18.5},handBack:{x:13,y:21},hipBack:{x:11,y:25},kneeBack:{x:12.5,y:27.5},heelBack:{x:11.5,y:29.5},torso:{x:6,y:16,width:7,height:9},shoulderFront:{x:5.5,y:16.5},elbowFront:{x:1.5,y:18.5},handFront:{x:5,y:21},hipFront:{x:6,y:25},kneeFront:{x:4.5,y:26.5},heelFront:{x:4.5,y:29.5}}]},o={bg:{x:166,y:239,width:180,height:33},frames:[{shoulderBack:{x:11.5,y:18.5},elbowBack:{x:10.5,y:20.5},handBack:{x:8,y:23},hipBack:{x:12,y:25},kneeBack:{x:13.5,y:27.5},heelBack:{x:14.5,y:31.5},torso:{x:5,y:16,width:8,height:9},shoulderFront:{x:7.5,y:18.5},elbowFront:{x:8.5,y:20.5},handFront:{x:11,y:23},hipFront:{x:7,y:25},kneeFront:{x:5.5,y:27.5},heelFront:{x:2.5,y:31.5}},{shoulderBack:{x:10.5,y:19.5},elbowBack:{x:8.5,y:19.5},handBack:{x:6,y:21},hipBack:{x:11,y:26},kneeBack:{x:11.5,y:28.5},heelBack:{x:10.5,y:31.5},torso:{x:5,y:17,width:8,height:9},shoulderFront:{x:8.5,y:19.5},elbowFront:{x:9.5,y:20.5},handFront:{x:12,y:23},hipFront:{x:7,y:26},kneeFront:{x:5.5,y:27.5},heelFront:{x:1.5,y:27.5}},{shoulderBack:{x:6.5,y:18.5},elbowBack:{x:6.5,y:21.5},handBack:{x:10,y:23},hipBack:{x:9,y:25},kneeBack:{x:9.5,y:28.5},heelBack:{x:8.5,y:31.5},torso:{x:6,y:16,width:7,height:9},shoulderFront:{x:7.5,y:18.5},elbowFront:{x:9.5,y:20.5},handFront:{x:12,y:22},hipFront:{x:9,y:25},kneeFront:{x:10.5,y:27.5},heelFront:{x:5.5,y:27.5}},{shoulderBack:{x:11.5,y:17.5},elbowBack:{x:9.5,y:19.5},handBack:{x:13,y:20},hipBack:{x:8,y:25},kneeBack:{x:7.5,y:27.5},heelBack:{x:5.5,y:31.5},torso:{x:6,y:15,width:7,height:9},shoulderFront:{x:6.5,y:17.5},elbowFront:{x:6.5,y:19.5},handFront:{x:9,y:22},hipFront:{x:12,y:25},kneeFront:{x:11.5,y:26.5},heelFront:{x:9.5,y:27.5}},{shoulderBack:{x:10.5,y:16.5},elbowBack:{x:12.5,y:18.5},handBack:{x:13,y:21},hipBack:{x:8,y:25},kneeBack:{x:6.5,y:27.5},heelBack:{x:4.5,y:31.5},torso:{x:6,y:15,width:7,height:9},shoulderFront:{x:5.5,y:17.5},elbowFront:{x:5.5,y:19.5},handFront:{x:7,y:22},hipFront:{x:12,y:25},kneeFront:{x:12.5,y:26.5},heelFront:{x:13.5,y:29.5}},{shoulderBack:{x:12.5,y:17.5},elbowBack:{x:13.5,y:18.5},handBack:{x:14,y:21},hipBack:{x:8,y:26},kneeBack:{x:6.5,y:28.5},heelBack:{x:3.5,y:31.5},torso:{x:6,y:16,width:7,height:9},shoulderFront:{x:5.5,y:17.5},elbowFront:{x:4.5,y:19.5},handFront:{x:4,y:22},hipFront:{x:12,y:26},kneeFront:{x:12.5,y:28.5},heelFront:{x:13.5,y:31.5}},{shoulderBack:{x:11.5,y:18.5},elbowBack:{x:13.5,y:19.5},handBack:{x:15,y:22},hipBack:{x:8,y:28},kneeBack:{x:6.5,y:27.5},heelBack:{x:3.5,y:27.5},torso:{x:5,y:17,width:8,height:9},shoulderFront:{x:5.5,y:18.5},elbowFront:{x:3.5,y:19.5},handFront:{x:2,y:22},hipFront:{x:11,y:26},kneeFront:{x:10.5,y:28.5},heelFront:{x:10.5,y:31.5}},{shoulderBack:{x:12.5,y:17.5},elbowBack:{x:11.5,y:18.5},handBack:{x:14,y:21},hipBack:{x:11,y:26},kneeBack:{x:9.5,y:27.5},heelBack:{x:6.5,y:27.5},torso:{x:6,y:16,width:7,height:9},shoulderFront:{x:6.5,y:17.5},elbowFront:{x:4.5,y:19.5},handFront:{x:3,y:22},hipFront:{x:9,y:26},kneeFront:{x:8.5,y:28.5},heelFront:{x:8.5,y:31.5}},{shoulderBack:{x:10.5,y:17.5},elbowBack:{x:12.5,y:18.5},handBack:{x:13,y:21},hipBack:{x:12,y:24},kneeBack:{x:10.5,y:26.5},heelBack:{x:8.5,y:28.5},torso:{x:5,y:15,width:8,height:9},shoulderFront:{x:5.5,y:17.5},elbowFront:{x:4.5,y:19.5},handFront:{x:4,y:22},hipFront:{x:8,y:25},kneeFront:{x:7.5,y:28.5},heelFront:{x:6.5,y:31.5}},{shoulderBack:{x:11.5,y:17.5},elbowBack:{x:11.5,y:18.5},handBack:{x:12,y:21},hipBack:{x:12,y:24},kneeBack:{x:12.5,y:26.5},heelBack:{x:12.5,y:29.5},torso:{x:6,y:15,width:7,height:9},shoulderFront:{x:6.5,y:17.5},elbowFront:{x:5.5,y:19.5},handFront:{x:6,y:22},hipFront:{x:9,y:25},kneeFront:{x:7.5,y:28.5},heelFront:{x:5.5,y:31.5}}]},n=(e,t)=>({x:0|e,y:0|t}),h=(e,t,o,n,h,a)=>Math.abs(e*(n-a)+o*(a-t)+h*(t-n)),a=(e,t,o,n)=>h(t.x,t.y,o.x,o.y,n.x,n.y)===h(e.x,e.y,o.x,o.y,n.x,n.y)+h(t.x,t.y,e.x,e.y,n.x,n.y)+h(t.x,t.y,o.x,o.y,e.x,e.y),y=(e,t,o)=>{e=n(e.x,e.y),t=n(t.x,t.y),o=n(o.x,o.y);const h=[],y=Math.min(e.x,t.x,o.x),r=Math.max(e.x,t.x,o.x),x=Math.min(e.y,t.y,o.y),i=Math.max(e.y,t.y,o.y);for(let n=y;n<=r;n++)for(let y=x;y<=i;y++)a({x:n,y},e,t,o)&&h.push({x:0|n,y:0|y});return h},r=(e,t,o,n)=>[...y(e,t,o),...y(e,o,n)],x=(e,t,o,h)=>{e|=0,t|=0,h|=0;const a=[];for(let y=-(o|=0);y<=o;y++){const r=h*Math.sqrt(1-y*y/(o*o));for(let o=-r;o<=r;o++)a.push(n(e+y,t+o))}return a},i=(e,t,o)=>x(e,t,o,o),l=(e,t,o,h,a)=>{const y=(o|=0)-(e|=0),r=(h|=0)-(t|=0),x=Math.atan2(r,y),i=a/2,l=e+Math.cos(x-Math.PI/2)*i,c=t+Math.sin(x-Math.PI/2)*i,d=e+Math.cos(x+Math.PI/2)*i,s=t+Math.sin(x+Math.PI/2)*i,k=o+Math.cos(x+Math.PI/2)*i,f=h+Math.sin(x+Math.PI/2)*i,m=o+Math.cos(x-Math.PI/2)*i,g=h+Math.sin(x-Math.PI/2)*i;return[n(d,s),n(l,c),n(m,g),n(k,f)]},d="#002a60",s="#0043e6",k="#f2de00",f="#008a31",m=e=>{const{width:t,height:o}=e.bg,n=e.frames.length,h=t/n,a=[];for(let t=0;t<n;t++){const n=document.createElement("canvas");n.width=h,n.height=o;const y=n.getContext("2d"),x=e.frames[t],{shoulderBack:c,elbowBack:m,handBack:g,hipBack:w,kneeBack:F,heelBack:p,shoulderFront:B,elbowFront:M,handFront:u,hipFront:b,kneeFront:I,heelFront:v,torso:S}=x,R=(e,t,o,n)=>{const h=i(t.x,t.y,n),a=i(o.x,o.y,n),x=l(t.x,t.y,o.x,o.y,n),c=[...h,...a,...r(...x)];y.fillStyle=e;for(const{x:e,y:t}of c)y.fillRect(e,t,1,1)};R(d,c,m,2),R(d,m,g,2),R(f,w,F,2),R(f,F,p,2),y.fillStyle="red";const T=r({x:S.x,y:S.y},{x:S.x+S.width,y:S.y},{x:S.x+S.width,y:S.y+S.height},{x:S.x,y:S.y+S.height});for(const{x:e,y:t}of T)y.fillRect(e,t,1,1);const E=S.width/2,P=S.height/2,C=S.x+S.width/2-E/2,A=S.y-P-1;y.fillStyle="darkred";const L=r({x:C,y:A},{x:C+E,y:A},{x:C+E,y:A+P},{x:C,y:A+P});for(const{x:e,y:t}of L)y.fillRect(e,t,1,1);R(s,B,M,2),R(s,M,u,2),R(k,b,I,2),R(k,I,v,2),a.push(n)}return{frames:a,frame:0,duration:1e3}},g=c;g.width=e,g.height=e;const w=g.getContext("2d"),F=(t=innerWidth,o=innerHeight)=>{const n=t>o?o/e:t/e;g.width=Math.floor(t/n),g.height=Math.floor(o/n)};addEventListener("resize",(()=>F()));const p={startTime:0,lastTime:0,elapsedTime:0,deltaTime:0},B=[],M=new Image,u=[],b={skyImage:M,mountainImage:M,groundImage:M,treeImage:M,girlIdleFrames:u,girlWalkFrames:u},I={type:2,x:0,y:0,image:void 0,anim:"idle",speed:0,acceleration:0,direction:1,intersects:1},v=e=>{"ArrowLeft"===e.key?(I.direction=-1,I.acceleration=.125):"ArrowRight"===e.key&&(I.direction=1,I.acceleration=-.125)},S=e=>{"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||(I.acceleration=0)},R=e=>{let t;if(1===e.type||2===e.type){const o=e.image[e.anim];t=o.frames[o.frame]}else t=e.image;return t};let T=[];const E=e=>{p.startTime||(p.startTime=e,p.lastTime=e),p.elapsedTime=e-p.startTime,p.deltaTime=e-p.lastTime,p.lastTime=e,(e=>{(e=>{for(const e of B){if(1===e.type||2===e.type){const{elapsedTime:t}=p,o=e.image[e.anim],{duration:n,frames:h}=o,a=h.length,y=Math.floor(t/n*a)%a;o.frame=y}void 0!==e.speed&&void 0!==e.acceleration&&(e.speed+=e.acceleration,e.speed*=.95,e.x-=e.speed,Math.abs(e.speed)<.1?(e.speed=0,1!==e.type&&2!==e.type||(e.anim="idle")):1!==e.type&&2!==e.type||(e.anim="walk"))}})(),(()=>{T=[];for(let e=0;e<B.length;e++){const t=B[e];if(t.blocks||t.intersects)for(let o=0;o<B.length;o++){const n=B[o];if(e!==o&&(n.blocks||n.intersects)){const h=R(t),a=R(n),y=t.x,r=t.y,x=h.width,i=h.height,l=n.x,c=n.y,d=a.width,s=a.height;y<l+d&&y+x>l&&r<c+s&&r+i>c&&T.push([e,o])}}}})();for(let e=0;e<T.length;e++){const[t,o]=T[e],n=B[t];B[t].intersects&&B[o].blocks&&"number"==typeof n.speed&&(n.x+=n.speed,n.speed=0)}})(),(e=>{g.width=g.width;const t=g.width/2,o=g.height/2;for(const e of B){const n=R(e),h=e.moveSpeed?(1-e.moveSpeed)*I.x:0;let a,y=Math.floor(e.x+h-I.x-n.width/2+t);a=2===e.tiling?g.height-n.height:1===e.tiling?o-n.height/2+e.y:g.height-n.height-b.groundImage.height+e.y,2===e.type&&(y=t-n.width/2,a=g.height-n.height-b.groundImage.height);const r=(t,o)=>{w.save(),-1===e.direction?(w.translate(t+n.width,o),w.scale(-1,1),w.drawImage(n,0,0)):w.drawImage(n,t,o),w.restore()};if((e.tiling||y+n.width>0&&y<g.width)&&(r(y,a),e.tiling)){let e=y-n.width;for(;e+n.width>0;)r(e,a),e-=n.width;let t=y+n.width;for(;t<g.width;)r(t,a),t+=n.width}}w.fillStyle="white",w.font="12px monospace",w.fillText(`x: ${I.x.toFixed(2)}`,10,20),w.fillText(`speed: ${I.speed.toFixed(2)}`,10,40),w.fillText(`accel: ${I.acceleration.toFixed(2)}`,10,60)})(),requestAnimationFrame(E)},P=(e=100,t=100,o="#2e6d35",n="#5b3138")=>{const h=3*Math.random()+5,a=document.createElement("canvas");a.width=e,a.height=t;const y=a.getContext("2d"),i=Math.floor(e/15),c=Math.floor(t/2),d=r({x:(e-i)/2,y:t-c},{x:(e+i)/2,y:t-c},{x:(e+i)/2,y:t},{x:(e-i)/2,y:t});y.fillStyle=n;for(const e of d)y.fillRect(e.x,e.y,1,1);const s=Math.floor(3*i/4),k=Math.floor(t/4);for(let a=0;a<h;a++){const h=Math.random()*Math.PI/2-Math.PI/4+Math.PI/2,a=e/2,i=t-c,d=a+k*Math.cos(h),f=i-k*Math.sin(h),m=l(a,i,d,f,s),g=r(...m);y.fillStyle=n;for(const e of g)y.fillRect(e.x,e.y,1,1);const w=x(d,f,2*s,s);y.fillStyle=o;for(const e of w)y.fillRect(e.x,e.y,1,1)}return a};(async()=>{const e=m(o),n=m(t),h=P(100,100),a=P(100,100,"#225027","#422429"),i=((e=32,t=64,o=4,n=2,h="#333333")=>{const a=document.createElement("canvas");a.width=e,a.height=t;const x=a.getContext("2d"),i=[],c=Math.floor(e/o);for(let e=0;e<o;e++){let o=e*c+c/2,n=o,h=0,a=t;o+=5*Math.random()-3,n+=5*Math.random()-3,h+=3*Math.random(),a-=3*Math.random(),i.push({x1:o,y1:h,x2:o,y2:a})}const d=[],s=Math.floor(t/n);for(let t=0;t<n;t++){let o=0,n=e,h=t*s+s/2,a=h;o+=3*Math.random(),n-=3*Math.random(),h+=5*Math.random()-3,a+=5*Math.random()-3,d.push({x1:o,y1:h,x2:n,y2:a})}const k=e=>{const t=l(e.x1,e.y1,e.x2,e.y2,3),o=r(...t);for(const{x:e,y:t}of o)x.fillRect(e,t,1,1)};x.fillStyle=h;for(const e of i){k(e);const t=y({x:e.x1-4,y:e.y1-8},{x:e.x1+4,y:e.y1-8},{x:e.x1,y:e.y1});for(const{x:e,y:o}of t)x.fillRect(e,o,1,1)}for(const e of d)k(e);return a})(32,64);b.skyImage=((e=800,t=300,o=10,n="#33d5fe",h="#caebfb",a=20,y=40,r=10,i=20)=>{const l=document.createElement("canvas");l.width=e,l.height=t;const c=l.getContext("2d");c.fillStyle=n,c.fillRect(0,0,l.width,l.height);for(let e=0;e<o;e++){const e=Math.random()*l.width,t=Math.random()*l.height/2,o=3+Math.floor(3*Math.random());for(let n=0;n<o;n++){const o=a+Math.random()*y,n=r+Math.random()*i,d=(Math.random()-.5)*y,s=(Math.random()-.5)*i,k=x(e+d,t+s,o,n);c.fillStyle=h,k.forEach((({x:e,y:t})=>{e=(e+l.width)%l.width,t=(t+l.height)%l.height,c.fillRect(e,t,1,1)}))}}return l})(800,300),b.mountainImage=((e=800,t=300,o="#a4b1bd",n="#628099",h="#1f65a1",a=.5,y=.4,x=.3)=>{const i=document.createElement("canvas");i.width=e,i.height=t;const l=i.getContext("2d"),c=(o,n,h)=>{const a=t*n;let y=a+(Math.random()*h-h/2);for(let x=1;x<e;x++){let e=Math.random()*h-h/2;y>a+n*t-h&&(e=-1*Math.abs(e));let c=y+e;c=Math.min(a+n*t,c),c=Math.max(.1*t,c);const d=r({x:x-1,y:t-y},{x,y:t-c},{x,y:t},{x:x-1,y:t});l.fillStyle=o,d.forEach((({x:e,y:t})=>{e=(e+i.width)%i.width,t=(t+i.height)%i.height,l.fillRect(e,t,1,1)})),y=c}};return c(o,a,15),c(n,y,10),c(h,x,5),i})(800,300),b.groundImage=((e=64,t=16,o=8,n="#4f942d",h="#874718")=>{const a=document.createElement("canvas");a.width=e,a.height=t;const x=a.getContext("2d"),i=Math.floor(t/3),l=Math.floor(2*t/3),c=Math.floor(e/o),d=r({x:0,y:0},{x:e-1,y:0},{x:e-1,y:t-1},{x:0,y:t-1});x.fillStyle=h;for(const e of d)x.fillRect(e.x,e.y,1,1);const s=r({x:0,y:0},{x:e-1,y:0},{x:e-1,y:i},{x:0,y:i});x.fillStyle=n;for(const e of s)x.fillRect(e.x,e.y,1,1);for(let e=0;e<o;e++){const t=e*c,o=y({x:t,y:i},{x:t+c-1,y:i},{x:t+c/2,y:l});for(const e of o)x.fillRect(e.x,e.y,1,1)}return a})(64,16);const c={idle:n,walk:e};I.image=c,B.push({type:0,x:0,y:0,image:b.skyImage,moveSpeed:.5,tiling:1},{type:0,x:0,y:0,image:b.mountainImage,moveSpeed:.8,tiling:1},{type:0,x:-500,y:0,image:i,blocks:1},{type:0,x:-200,y:0,image:h},{type:1,x:100,y:0,image:c,anim:"idle",direction:-1},{type:0,x:150,y:2,image:a,moveSpeed:.95},{type:0,x:200,y:0,image:h},{type:0,x:500,y:0,image:h},{type:0,x:800,y:0,image:i,blocks:1},{type:0,x:0,y:0,image:b.groundImage,moveSpeed:1,tiling:2},I),addEventListener("keydown",v),addEventListener("keyup",S),F(),requestAnimationFrame(E)})().catch(console.error)})();